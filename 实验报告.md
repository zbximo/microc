| 姓名   | 学号     | 班级       | 任务       | 权重   |
| ------ | -------- | ---------- | ---------- | ------ |
| Name   | No.      | Class      | Task       | Factor |
| 徐海东 | 31901028 | 计算机1901 | 编码、测试 | 1.0    |

## 解释器

### 类型检查：

#### 首字母要大写，不能小写；枚举完成；变量定义首字母小写

1. 步骤

   + 修改Clex.fsl 中关键词信息，正则表达式匹配首字母大写变量

   ![image-20220525134546123](实验报告.assets/image-20220525134546123.png)

2. 测试

```c
void main()
{
    // int a;
    Int A;
    // Int __;
    a = 1;
    print a;
}
```

![image-20220524214714911](实验报告.assets/image-20220524214714911.png)

如果类型小写、变量名以大写或__开头，则会报错提示：

![image-20220524214624940](实验报告.assets/image-20220524214624940.png)

![image-20220525194627441](实验报告.assets/image-20220525194627441.png)

### 未完全实现Float类型。

做的时候发现Store里面是存Int的，如果要增加float类型，难度有点大，因此就没有实现。**只做到**了能构造出AST这一部分。

同时字符串转数字的parse函数只能返回单精度浮点数Single，因此要去实现Double可能更困难。

1. 步骤

   1. 在Absyn.fs中增加Float类型，以及表达式

      ![image-20220525135241992](实验报告.assets/image-20220525135241992.png)

   2. 增加Clex.fsl 中关键词信息FLOAT、正则表达式提取浮点数

      ![image-20220525141053950](实验报告.assets/image-20220525141053950.png)

   3. 增加CPar.fsy中token的定义、FLOAT类型

   ![image-20220525135154003](实验报告.assets/image-20220525135154003.png)

   ![image-20220525135223856](实验报告.assets/image-20220525135223856.png)

2. 测试

   ![image-20220525135756327](实验报告.assets/image-20220525135756327.png)

   ![image-20220525134345029](实验报告.assets/image-20220525134345029.png)

   ![image-20220525135900865](实验报告.assets/image-20220525135900865.png)

   可以看到，输出的并不是1，但是AST能构造出来。

### 新增自增自减运算符（i++,i--,--i,++i）

1. 步骤

   1. 在Absyn.fs中添加表达式

      ![image-20220525141004839](实验报告.assets/image-20220525141004839.png)

   2. 在CLex.fsl中添加 ++ 和 -- 的词法

      ![image-20220525141523843](实验报告.assets/image-20220525141523843.png)

   3. 在CPar.fsy中添加token：SELFPLUS、 SELFMINUS；运算优先级；非左值情况定义

      ![image-20220525141708779](实验报告.assets/image-20220525141708779.png)

2. 测试

![image-20220525163522204](实验报告.assets/image-20220525163522204.png)

![image-20220525163555400](实验报告.assets/image-20220525163555400.png)

基本实现。

### 新增（+=，-=，*=，/= ）

1. 实现

   1. Clex.fsl中加入新规则

   2. CPar.fsy中定义token，增加非左值情况。

   ![image-20220525201428587](实验报告.assets/image-20220525201428587.png)

   3. Absyn.fs中加入新的expr  | ComplexOperation of string * access * expr

2. 测试

   ```c
   void main()
   {
       Int x;
       x = 10;
       x += 2;
       print x; //12
       x -= 2;
       print x; //10
       x *= 2;
       print x; // 20
       x /= 2;
       print x; //10
       x %= 2; //0
       print x;   
   }
   ```

![image-20220525201234558](实验报告.assets/image-20220525201234558.png)

新增 FOR
